---
wts:
  title: 01 - 在门户中创建虚拟机（10 分钟）
  module: Module 02 - Core Azure Services (Workloads)
ms.openlocfilehash: 010d6a19a66f6ac92627720379a4eb850b2ee423
ms.sourcegitcommit: 4a0bfef63f98844f16e2a364d156e96382b8fac5
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/04/2022
ms.locfileid: "144556866"
---
# <a name="01---create-a-virtual-machine-in-the-portal-10-min"></a>01 - 在门户中创建虚拟机（10 分钟）

在本演练中，我们将在 Azure 门户中创建一个虚拟机，连接到该虚拟机，安装 Web 服务器角色并进行测试。 

**注意**：请在本演练中花些时间单击并阅读信息图标。 

# <a name="task-1-create-the-virtual-machine"></a>任务 1：创建虚拟机 
1. 登录到 Azure 门户： https://portal.azure.com

3. 从门户菜单的“所有服务”边栏选项卡中，搜索并选择“虚拟机”，然后单击“+ 创建”并从下拉列表中选择“+ Azure 虚拟机”   。

4. 在“基本”选项卡上，填写以下信息（其他所有设置保留默认值）：

    | 设置 | 值 |
    |  -- | -- |
    | 订阅 | 使用提供的默认值 |
    | 资源组 | **新建资源组** |
    | 虚拟机名称 | **myVM** |
    | 区域 | **（美国）美国东部**|
    | 可用性选项 | 没有所需的基础结构冗余选项|
    | 映像 | Windows Server 2019 Datacenter - Gen2|
    | 大小 | Standard D2s v3|
    | 管理员帐户用户名 | **azureuser** |
    | 管理员帐号密码（请小心输入！） | **Pa$$w0rd1234**|
    | 入站端口规则 - | 允许选择端口****|
    | 选择入站端口 | RDP (3389) 和 HTTP (80) | 

5. 切换到“网络”选项卡，确保在“选择入站端口”部分中选中“HTTP (80) 和 RDP (3389)” 。

6. 切换到“管理”选项卡，然后在其“监视”部分中选择以下设置：

    | 设置 | 值 |
    | -- | -- |
    | 启动诊断 | **禁用**|

7. 其余值保留默认值，然后单击页面底部的“查看 + 创建”按钮。

8. 验证通过后，单击“创建”按钮。 部署虚拟机大约需要五到七分钟。

9. 你将在部署页面和通过“通知”区域（顶部菜单栏的钟形图标）收到更新。

# <a name="task-2-connect-to-the-virtual-machine"></a>任务 2：连接到虚拟机

在此任务中，我们将使用 RDP（远程桌面协议）连接到新虚拟机。 

1. 单击上方蓝色工具栏中的钟形图标，并在部署成功后选择“转到资源”。 

    **注意**：你也可以使用“部署”页中的“转到资源”链接。 

2. 在虚拟机“概述”边栏选项卡上，单击“连接”按钮并选择下拉列表中的“RDP”  。

    ![此屏幕截图显示了虚拟机属性，其中突出显示了“连接”按钮。](../images/0101.png)

    **注意**：以下说明介绍如何从 Windows 计算机连接到 VM。 在 Mac 上，需要 RDP 客户端（例如 Mac App Store 中的此远程桌面客户端），而在 Linux 计算机上，可以使用开放源代码 RDP 客户端。

2. 在“连接虚拟机”界面，保持默认选项，以便通过端口 3389 使用公共 IP 地址进行连接，然后单击“下载 RDP 文件” 。 此时屏幕左下角将下载一个文件。

3. 打开下载的 RDP 文件（位于实验室计算机的左下角）并在出现提示时单击“连接” 。 

    ![此屏幕截图显示了虚拟机属性，其中突出显示了“连接”按钮。 ](../images/0102.png)

4. 在“Windows 安全中心”窗口中，使用创建 VM azureuser 时使用的管理员凭据和密码 Pa$$w0rd1234 登录  。 

5. 在登录过程中，你可能会收到警告证书。 单击“是”或创建连接并连接到已部署的 VM。 你应该成功连接。

    ![此屏幕截图显示了“证书警告”对话框，此对话框通知用户存在不受信任的证书，其中突出显示了“是”按钮。 ](../images/0104.png)

实验室内将启动一个新的虚拟机 (myVM)。 关闭服务器管理器和弹出的仪表板窗口（单击右上角的“x”）。 此时会看到虚拟机的蓝色背景。 祝贺你！ 你已部署并连接到运行 Windows Server 的虚拟机。 

# <a name="task-3-install-the-web-server-role-and-test"></a>任务 3：安装 Web 服务器角色并进行测试

在此任务中，我们将在刚创建的虚拟机中的服务器上安装 Web 服务器角色，并确保可以显示默认的 IIS 欢迎页面。 

1. 在新打开的虚拟机的搜索栏中，搜索 PowerShell 以启动 PowerShell，找到后依次右键单击“Windows PowerShell”和“以管理员身份运行”  。

    ![此屏幕截图显示了虚拟机桌面，其中已单击“开始”按钮，并选择了“PowerShell”，且突出显示“以管理员身份运行”。](../images/0105.png)

2. 在 PowerShell 中运行以下命令，在虚拟机中安装 Web 服务器功能。 （粘贴命令并按 ENTER 键开始安装）。

    ```PowerShell
    Install-WindowsFeature -name Web-Server -IncludeManagementTools
    ```
  
3. 完成后会看到一个值为“True”的提示符，指示“成功” 。 你无需重启虚拟机即可完成安装。 单击虚拟机顶部中心蓝色栏上的“x”，关闭与 VM 的 RDP 连接。 还可以单击顶部中心蓝色栏上的“-”将其最小化。

    ![此屏幕截图显示了 Windows PowerShell 命令提示符，其中命令 Install-WindowsFeature -name Web-Server -IncludeManagementTools 已成功完成，并且输出声明了这一点。](../images/0106.png)

4. 返回门户，导航回 myVM 的“概述”边栏选项卡，然后使用“单击复制到剪贴板”按钮复制 myVM 的公共 IP 地址，打开新的浏览器选项卡，将该公共 IP 地址粘贴到 URL 文本框中，然后按 Enter 键以浏览到它  。

    ![此屏幕截图显示了 Azure 门户“虚拟机属性”窗格，其中复制了 IP 地址。](../images/0107.png)

5. 随即将显示默认的 IIS Web 服务器欢迎页面。

    ![此屏幕截图显示了通过 Web 浏览器中的公共 IP 地址访问的默认 IIS Web 服务器欢迎页面。](../images/0108.png)

祝贺你！ 你已创建了一个运行 Web 服务器的新 VM，可通过其公共 IP 地址对其进行访问。 如果你有一个要托管的 Web 应用程序，则可以将这些应用程序文件部署到虚拟机并进行托管，以便在已部署的虚拟机上进行公共访问。


**注意**：为了避免产生额外费用，可以选择删除此资源组。 搜索资源组，单击你的资源组，然后单击“删除资源组”。 验证资源组的名称，然后单击“删除”。 监视“通知”以查看删除是否成功完成。 
